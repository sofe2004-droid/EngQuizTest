<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PDFtoQuiz - ê²°ê³¼ë³´ê¸°</title>
  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
  <!-- ì»¤ìŠ¤í…€ CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
  <!-- ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">
      <a class="navbar-brand" href="#">ğŸ“š PDFtoQuiz</a>
      <div class="navbar-text text-white">
        <span class="me-3">{{ username }}ë‹˜</span>
        <a href="{{ url_for('admin') }}" class="btn btn-outline-light btn-sm me-2">ê´€ë¦¬ì</a>
        <a href="{{ url_for('logout') }}" class="btn btn-outline-light btn-sm">ë¡œê·¸ì•„ì›ƒ</a>
      </div>
    </div>
  </nav>
  
  <div class="container mt-5 mb-5">
    <!-- ì ìˆ˜ ìš”ì•½ -->
    <div class="result-summary text-center mb-5">
      <div class="card shadow-lg">
        <div class="card-body p-5">
          <h2 class="mb-4">ì‹œí—˜ ê²°ê³¼</h2>
          <div class="score-display">
            <h1 class="display-1 mb-3">
              <span class="score-number">{{ score }}</span>
              <span class="text-muted"> / </span>
              <span class="text-muted">{{ total }}</span>
            </h1>
            <h4 class="text-muted mb-4">ì´ {{ total }}ë¬¸ì œ ì¤‘ {{ score }}ë¬¸ì œ ì •ë‹µ</h4>
            
            {% set percentage = (score / total * 100) | int %}
            <div class="progress mb-3" style="height: 30px;">
              <div class="progress-bar 
                          {% if percentage >= 80 %}bg-success
                          {% elif percentage >= 60 %}bg-primary
                          {% elif percentage >= 40 %}bg-warning
                          {% else %}bg-danger{% endif %}" 
                   role="progressbar" 
                   style="width: {{ percentage }}%"
                   aria-valuenow="{{ percentage }}" 
                   aria-valuemin="0" 
                   aria-valuemax="100">
                <strong>{{ percentage }}%</strong>
              </div>
            </div>
            
            <p class="lead">
              {% if percentage >= 80 %}
                <i class="bi bi-emoji-smile-fill text-success"></i> í›Œë¥­í•©ë‹ˆë‹¤!
              {% elif percentage >= 60 %}
                <i class="bi bi-emoji-smile text-primary"></i> ì˜í–ˆìŠµë‹ˆë‹¤!
              {% elif percentage >= 40 %}
                <i class="bi bi-emoji-neutral text-warning"></i> ì¡°ê¸ˆ ë” ë…¸ë ¥í•˜ì„¸ìš”!
              {% else %}
                <i class="bi bi-emoji-frown text-danger"></i> ë” ê³µë¶€ê°€ í•„ìš”í•©ë‹ˆë‹¤!
              {% endif %}
            </p>
          </div>
        </div>
      </div>
    </div>
    
    <!-- ë¬¸ì œë³„ ìƒì„¸ ê²°ê³¼ -->
    <div class="detailed-results mb-5">
      <h3 class="mb-4">ë¬¸ì œë³„ ìƒì„¸ ê²°ê³¼</h3>
      
      {% for result in detailed_results %}
      <div class="card mb-3 {% if result.is_correct %}border-success{% else %}border-danger{% endif %}">
        <div class="card-header {% if result.is_correct %}bg-success bg-opacity-10{% else %}bg-danger bg-opacity-10{% endif %}">
          <div class="d-flex justify-content-between align-items-center">
            <h5 class="mb-0">ë¬¸ì œ {{ result.question_num }}</h5>
            <span class="badge {% if result.is_correct %}bg-success{% else %}bg-danger{% endif %}">
              {% if result.is_correct %}
                <i class="bi bi-check-circle-fill"></i> ì •ë‹µ
              {% else %}
                <i class="bi bi-x-circle-fill"></i> ì˜¤ë‹µ
              {% endif %}
            </span>
          </div>
        </div>
        <div class="card-body">
          <p class="question-text mb-3"><strong>ë¬¸ì œ:</strong> {{ result.question }}</p>
          
          <div class="row mb-3">
            <div class="col-md-6">
              <p class="mb-1"><strong>ë³´ê¸°:</strong></p>
              <ul class="list-unstyled ms-3">
                <li class="{% if result.student_answer == 'A' %}fw-bold{% endif %}{% if result.correct_answer == 'A' %} text-success{% endif %}">
                  A. {{ result.example_a }}
                  {% if result.correct_answer == 'A' %}<i class="bi bi-check-circle-fill text-success ms-1"></i>{% endif %}
                </li>
                <li class="{% if result.student_answer == 'B' %}fw-bold{% endif %}{% if result.correct_answer == 'B' %} text-success{% endif %}">
                  B. {{ result.example_b }}
                  {% if result.correct_answer == 'B' %}<i class="bi bi-check-circle-fill text-success ms-1"></i>{% endif %}
                </li>
                <li class="{% if result.student_answer == 'C' %}fw-bold{% endif %}{% if result.correct_answer == 'C' %} text-success{% endif %}">
                  C. {{ result.example_c }}
                  {% if result.correct_answer == 'C' %}<i class="bi bi-check-circle-fill text-success ms-1"></i>{% endif %}
                </li>
                <li class="{% if result.student_answer == 'D' %}fw-bold{% endif %}{% if result.correct_answer == 'D' %} text-success{% endif %}">
                  D. {{ result.example_d }}
                  {% if result.correct_answer == 'D' %}<i class="bi bi-check-circle-fill text-success ms-1"></i>{% endif %}
                </li>
              </ul>
            </div>
            <div class="col-md-6">
              <p class="mb-1"><strong>ì„ íƒí•œ ë‹µ:</strong> 
                <span class="badge {% if result.is_correct %}bg-success{% else %}bg-danger{% endif %}">
                  {{ result.student_answer }}
                </span>
              </p>
              <p class="mb-1"><strong>ì •ë‹µ:</strong> 
                <span class="badge bg-success">{{ result.correct_answer }}</span>
              </p>
            </div>
          </div>
          
          <div class="alert alert-info mb-0">
            <strong><i class="bi bi-lightbulb-fill"></i> í•´ì„¤:</strong> {{ result.explanation }}
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
    
    <!-- ê³¼ê±° ê¸°ë¡ -->
    {% if all_attempts %}
    <div class="history-section mb-5">
      <h3 class="mb-4">ê³¼ê±° ê¸°ë¡</h3>
      <div class="card">
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th>ë‚ ì§œ</th>
                  <th>ì‹œê°„</th>
                  <th>ì ìˆ˜</th>
                  <th>ì •ë‹µë¥ </th>
                </tr>
              </thead>
              <tbody>
                {% for attempt in all_attempts %}
                <tr>
                  <td>{{ attempt.date }}</td>
                  <td>{{ attempt.time }}</td>
                  <td>{{ attempt.score }} / {{ attempt.total }}</td>
                  <td>
                    {% set percentage = (attempt.score / attempt.total * 100) | int %}
                    <div class="progress" style="height: 20px; width: 150px;">
                      <div class="progress-bar 
                                  {% if percentage >= 80 %}bg-success
                                  {% elif percentage >= 60 %}bg-primary
                                  {% elif percentage >= 40 %}bg-warning
                                  {% else %}bg-danger{% endif %}" 
                           role="progressbar" 
                           style="width: {{ percentage }}%">
                        {{ percentage }}%
                      </div>
                    </div>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    {% endif %}
    
    <!-- ì•¡ì…˜ ë²„íŠ¼ -->
    <div class="text-center">
      <a href="{{ url_for('quiz') }}" class="btn btn-primary btn-lg">
        <i class="bi bi-arrow-clockwise"></i> ë‹¤ì‹œ ë¬¸ì œí’€ê¸°
      </a>
    </div>
  </div>
  
  <!-- Bootstrap 5 JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
